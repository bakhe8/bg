๐งญ **BGLApp Refactor Roadmap โ ุฎุงุฑุทุฉ ุฅุนุงุฏุฉ ุงูููููุฉ ุงูุฑุณููุฉ**

---

## ๐งฉ ุงููุฑุญูุฉ 0 โ ุงููุฏู ูุงููุจุงุฏุฆ

**๐ฏ ุงููุฏู:**  
ุชุญููู BGLApp ูู ูููู โุชุฌููุนู ูุงุฌุญโ ุฅูู ูููู ููุฏุณู ูุณุชุฏุงู ูุงุจู ูููุดุฑุ ูุงูุงุฎุชุจุงุฑุ ูุงูุชุทููุฑ ุงููุชูุงุฒูุ ูุงูุฅุตุฏุงุฑ ุงููุณุชูุจูู.

**๐ง ุงููุจุงุฏุฆ:**
1. ุงูุงูุชูุงู ุงูุชุฏุฑูุฌู โ ูุง ูุชู ุญุฐู ุฃู ููู ุฃู ููู ุญุชู ูุชู ุงูุชุฃูุฏ ูู ุนูู ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ.  
2. ุงููุญุฏุงุช ุงููููุตูุฉ โ ูู ูุญุฏุฉ (Excel / API / UI / Logs) ุชููู ููุชููุฉ ุฐุงุชููุง.  
3. ุงููุฑุฌุนูุฉ ุงูุซุงุจุชุฉ โ ูุณุงุฑุงุช ุงูุจูุฆุฉ (runtime / data / logs) ุชุจูู ููุณูุง ุญุชู ุจุนุฏ ุงูููู.  
4. ุนุฏู ูุณุฑ portable build โ `build_portable.py` ูุฌุจ ุฃู ูุนูู ููุง ูู ุฏูู ุชุนุฏูู ูุจูุฑ.  
5. ุงููุฎุฑุฌุงุช ููุณูุง ุฏุงุฆููุง โ ูููุง ุชุบููุฑ ุงูููุฏุ ุงููุชุงุฆุฌ (JSON, PDF, Logs) ูุฌุจ ุฃู ุชุจูู ูุทุงุจูุฉ.

---

## ๐งฑ ุงููุฑุญูุฉ 1 โ ุฅูุดุงุก ุงูุจููุฉ ุงูุฌุฏูุฏุฉ

ุฃูุดุฆ ูุฌูุฏ ุฌุฏูุฏ ุจุฌุงูุจ ุงูุฅุตุฏุงุฑ ุงูุญุงูู (ููุนูู ุงูุขูู):

```
BGLApp_Refactor/
โ
โโโ core/
โ   โโโ excel/
โ   โ   โโโ converter.py
โ   โ   โโโ normalizer.py
โ   โ   โโโ validators.py
โ   โโโ pdf/
โ   โ   โโโ generator.py
โ   โโโ logs/
โ   โ   โโโ logger.py
โ   โโโ config/
โ   โ   โโโ paths.py
โ   โ   โโโ constants.py
โ   โโโ __init__.py
โ
โโโ api/
โ   โโโ routes/
โ   โ   โโโ convert_excel.py
โ   โ   โโโ save_letter.py
โ   โ   โโโ review.py
โ   โ   โโโ health.py
โ   โโโ dependencies.py
โ   โโโ server.py
โ   โโโ __init__.py
โ
โโโ web/
โ   โโโ templates/
โ   โโโ static/
โ   โ   โโโ css/
โ   โ   โโโ js/
โ   โ   โโโ images/
โ   โโโ routes.py
โ   โโโ __init__.py
โ
โโโ tests/
โ   โโโ test_excel_converter.py
โ   โโโ test_api.py
โ   โโโ test_pdf_generator.py
โ   โโโ conftest.py
โ
โโโ data/
โ   โโโ logs/
โ   โโโ exports/
โ   โโโ samples/
โ
โโโ launcher/
โ   โโโ run_portable.py
โ   โโโ run_portable.bat
โ   โโโ run_portable.sh
โ   โโโ icon.ico
โ
โโโ runtime/
โ   โโโ Lib/
โ   โโโ site-packages/
โ
โโโ build/
โ   โโโ build_portable.py
โ   โโโ create_shortcut.vbs
โ   โโโ spec/
โ
โโโ docs/
โ   โโโ refactor_map.md
โ   โโโ api_contract.md
โ   โโโ changelog.md
โ   โโโ architecture.md
โ
โโโ README.md
โโโ requirements.txt
โโโ app.py
```

---

## ๐ ุงููุฑุญูุฉ 2 โ ุฎุฑูุทุฉ ุงูููู (Refactor Map)

### 2.1 ูู ุงููุธุงู ุงูุญุงูู ุฅูู ุงููุธุงู ุงูุฌุฏูุฏ

| ุงููุตุฏุฑ ุงูุญุงูู                          | ุงููุฌูุฉ ุงูุฌุฏูุฏุฉ                 | ุงูููุงุญุธุงุช                                      |
|----------------------------------------|--------------------------------|------------------------------------------------|
| `main/api/server.py`                   | `api/server.py`                | ูุจูู ูู ููุทุฉ ุงูุชุฌููุน ููู FastAPI.              |
| `main/api/logging_utils.py`            | `core/logs/logger.py`          | ููุนุงุฏ ุชุบูููู ููุงุฆู LoggerManager.             |
| `main/api/routes/convert_excel.py`     | `api/routes/convert_excel.py`  | โ ููุณุชุจุฏูุฉ ุจูุงุฌูุฉ FastAPI ุจุงููุงูู.            |
| `main/api/routes/save_letter.py`       | `api/routes/save_letter.py`    | โ ููุณุชุจุฏูุฉ ุจูุงุฌูุฉ FastAPI ุจุงููุงูู.            |
| `main/api/routes/review_routes.py`     | `api/routes/review.py`         | โ ุฃุนูุฏุช ุงูุชุณููุฉ ูุงูุฏูุฌ ูู FastAPI.            |
| `main/api/routes/aliases.py`           | `api/routes/aliases.py`        | โ ุฃุตุจุญุช ุฑุงูุชุฑ FastAPI ูุชุณุชุฎุฏู ุงูุซูุงุจุช ุงูุฌุฏูุฏุฉ.|
| `main/web/view_routes.py`              | `web/routes.py`                | โ ูุงุฌูุฉ FastAPI + ุชูุฏูู ูููุงุช ุงููุงุฌูุฉ ูุจุงุดุฑุฉ. |
| `transition/integration_tests/`        | `tests/`                       | โ ููููุช ุฅูู PyTest (`tests/test_*`).           |
| `excel_to_json_converter.py`           | `core/excel/converter.py`      | ูููุตู ููู ุงูุชูุธูู ูุงููุนุงูุฌุฉ.                   |
| `test_excel_converter.py`              | `tests/test_excel_converter.py`| ุจุฏูู ุชุนุฏูู.                                    |
| `letter_model.py`                      | `core/pdf/generator.py`        | ููุญููู ุฅูู ูุญุฏุฉ ุชูููุฏ PDF ูุฑูุฒูุฉ.             |
| `bank_model.py`                        | `core/config/constants.py`     | ุชูููู ุจูุงูุงุช ุงูุจููู ุฅูู JSON ูุณุชูู.           |
| `__init__.py` ูู ุงูุฌุฐุฑ                 | ูุจูู                           | ูููุฆ ุงูุญุฒู ุงูุฌุฏูุฏุฉ.                            |

### 2.2 ุงููููุงุช ุงูุฌุฏูุฏุฉ ุงูุชู ุชูุถุงู

| ุงูููู                         | ุงููุธููุฉ                                          |
|------------------------------|--------------------------------------------------|
| `core/excel/normalizer.py`   | ุชูุญูุฏ ุงูููู ูุงูุฃุนูุฏุฉ ูู ูููุงุช Excel.            |
| `core/excel/validators.py`   | ูุญุต ุตูุงุญูุฉ ุงูุจูุงูุงุช ูุจู ุงูุชุญููู.               |
| `core/config/paths.py`       | ุชุนุฑูู ุฌููุน ุงููุณุงุฑุงุช ุงูุซุงุจุชุฉ.                   |
| `core/pdf/generator.py`      | ุทุจูุฉ ุชูููุฏ PDF (WeasyPrint ุฃู jsPDF).          |
| `tests/conftest.py`          | ุชููุฆุฉ fixtures ููุงุฎุชุจุงุฑุงุช.                     |
| `docs/refactor_map.md`       | ุชูุซูู ุนูููุฉ ุงูููู (ูุฐุง ุงูููู).                 |

---

## โ๏ธ ุงููุฑุญูุฉ 3 โ ุงูุชุญูู ูู ุงูุณูุงูุฉ (Validation Phase)

ุจุนุฏ ููู ูู ูุญุฏุฉุ ูููุฐ ุงูุชุงูู ุจุงูุชุชุงุจุน:

1. **ุชุดุบูู ูุญูู:**
   ```
   python app.py
   ```
   ุชุฃูุฏ ุฃู ุงููุงุฌูุฉ ุชูุชุญ ุจูุฌุงุญ.

2. **ุงุฎุชุจุงุฑุงุช ุขููุฉ:**
   ```
   pytest -v
   ```

3. **ุงุฎุชุจุงุฑ ุงูุจูุงุก ุงููุญููู:**
   ```
   python build/build_portable.py
   dist/BGLApp_Portable/BGLApp.exe
   ```
   ุชุฃูุฏ ุฃูู ูุนูู ููุง ูุจู.

4. **ููุงุฑูุฉ ุงููุฎุฑุฌุงุช:**  
   ุงูุชุญ ูููุงุช JSON / PDF ุงููุงุชุฌุฉ ูุจู ูุจุนุฏ ุงูููู ูุชุฃูุฏ ูู ุชุทุงุจููุง 1:1.

---

## ๐งฐ ุงููุฑุญูุฉ 4 โ ุชุญุณููุงุช ุฅุถุงููุฉ ุจุนุฏ ุงูููู

| ุงูุชุญุณูู                     | ุงูููุงู                 | ุงููุงุฆุฏุฉ                                         |
|----------------------------|------------------------|-------------------------------------------------|
| โ ุฅุถุงูุฉ `manifest.json`      | `core/config/manifest.*` | ุชุนุฑูู ุงูุฅุตุฏุงุฑ ูุชุงุฑูุฎ ุงูุจูุงุก (ูููุฑุฃ ูู ุงููุธุงู). |
| โ ุชููุฆุฉ logger ูุฑู           | `core/logs/logger.py`     | ุณุฌู JSON/Text ูุงุจู ููุชุตุฏูุฑ ุนุจุฑ `BGLAPP_LOG_FORMAT`. |
| โ ุฅุถุงูุฉ Config Class         | `core/config/paths.py`    | `EnvironmentConfig` ููุชุจุฏูู ุจูู ุงูุจูุฆุงุช.        |
| โ ุฏูุฌ Flask + FastAPI        | `app.py` / `api/server.py`| FastAPI ูู ุงููุตุฏุฑ ุงููุญูุฏุ ูFlask ูุฏูุฌ ุนุจุฑ WSGI. |
| โ ุฅุถุงูุฉ CLI ุจุณูุท             | `launcher/cli.py`         | ุฃูุงูุฑ `serve/test/build-portable` ูู ุณุทุฑ ุงูุฃูุงูุฑ. |

---

## ๐งฉ ุงููุฑุญูุฉ 5 โ ูุฑุญูุฉ ุงูุฅูุชุงุฌ ุงูุชุฌุฑูุจู (Pilot Production)

ุจุนุฏ ุฅุชูุงู ุงูููู ูุงูุชุญูู:
1. โ **ุชุฌููุฏ ุงููุณุฎุฉ ุงููุฏููุฉ:** ุชู ุฅูุดุงุก `legacy/BGLApp_v1_Stable/` ููุฑุฌุน ููุฅุตุฏุงุฑ ุงูุณุงุจู (ูุน ุฅุดุนุงุฑ ูุดูุฑ ููููุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู).
2. โ **ุชุณููุฉ ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ:** `BGLApp_Refactor` ููุซู ุงูุขู **BGLApp_v2** (Pilot Release).
3. โ **ุชุญุฏูุซ manifest:** `core/config/manifest.json` ูุญูู ุงูุฅุตุฏุงุฑ `2.0.0` ูุญุงูุฉ Pilot ููุงุฆูุฉ ุงููุฒุงูุง.
4. โ **ุฎุทุฉ ุงูุฅุตุฏุงุฑุงุช ุงููุงุฏูุฉ** ููุซููุฉ ุฏุงุฎู `manifest.json`:
   - **BGLApp_v2.1**: ูุญุฏุฉ PDF ุฎุงุฏููุฉ WeasyPrint.
   - **BGLApp_v2.2**: ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุงููููุงุช (ุณุญุจ ูุฅููุงุช ูุชุนุฏุฏ).
   - **BGLApp_v3.0**: ููุญุฉ ูุฑุงุฌุนุฉ ุฐููุฉ (Smart Review Dashboard).

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

| ุงูุฎุงุตูุฉ                | ุจุนุฏ ุงูููููุฉ |
|------------------------|-------------|
| ูุงุจููุฉ ุงูุตูุงูุฉ         | โ ุนุงููุฉ ุฌุฏูุง |
| ุงูุงุฎุชุจุงุฑ ุงูุขูู         | โ ูุฏูุฌ ุจุดูู ุฑุณูู |
| ุงููุดุฑ ูุงูุฅูุชุงุฌ         | โ ุฌุงูุฒ ุจุงููุงูู |
| ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ   | โ ุฃุณูู ุจู 70ูช |
| ุงูุชูุงูู ูุน Portable    | โ ูุถููู |
| ุงูุฃุฏุงุก ูุงูุงุณุชูุฑุงุฑ      | โ ูุชููู ููุฑุงูุจ |
