# ุฎุทุฉ ุฅุนุงุฏุฉ ุจูุงุก ูุธุงู BGLApp Lite โ Smart Excel Processor Edition

---

## 1. ุงูููุฏูุฉ ูุงูููุณูุฉ ุงูุนุงูุฉ

ููุฏู ูุดุฑูุน **BGLApp Lite** ุฅูู ุฅุนุงุฏุฉ ุจูุงุก ุงููุธุงู ุงูุญุงูู (BGLApp) ุจุทุฑููุฉ ุฃูุซุฑ ุจุณุงุทุฉ ูููุงุกุฉุ ุจุญูุซ ูุชุญูู ูู ุชุทุจูู ุฎุงุฏูู ูุนูุฏ ูุนุชูุฏ ุนูู Flask ููุชุตูุญ ููุจุ ุฅูู **ุจุฑูุงูุฌ ููุชุจู ุฐูู** ูุนูู ุจุดูู ูุณุชูู ุนูู ูุธุงู Windowsุ ุฏูู ุงูุญุงุฌุฉ ุฅูู ุฃู ุฎูุงุฏู ุฃู ุฅุนุฏุงุฏุงุช ูุนูุฏุฉ.

ุงูููุณูุฉ ุงูุฃุณุงุณูุฉ:

* **ุงูุฐูุงุก ูู ุงูุจุณุงุทุฉ:** ุฌุนู ุฃุนูุฏ ุงููุฑุงุญู (ูุนุงูุฌุฉ ูููุงุช Excel ุงููุฎุชููุฉ) ุชุชู ุจุฐูุงุก ุชููุงุฆู.
* **ุงูููุซูููุฉ:** ุฅูุชุงุฌ ุฎุทุงุจุงุช ุถูุงู ุฑุณููุฉ ุจููุณ ุงูุดูู ุงูุงุญุชุฑุงูู ุงูุญุงูู.
* **ุงูุงุณุชููุงููุฉ:** ุงูุนูู ุฏูู ุฅูุชุฑูุช ุฃู ุฃุฏูุงุช ุฎุงุฑุฌูุฉ.
* **ูุงุจููุฉ ุงูููู (Portable Runtime):** ุชุดุบูู ุงูุจุฑูุงูุฌ ุนูู ุฃู ุฌูุงุฒ ุฏูู ุชุซุจูุช.

---

## 2. ุงููุดููุฉ ุงูุญุงููุฉ

ุงููุธุงู ุงูุญุงูู ููู ูููู ูุนูุฏ:

* ูุนุชูุฏ ุนูู ุฎุงุฏู Flaskุ ูุงุฌูุฉ ููุจ (HTML/JS)ุ ูููุชุจุงุช ุฎุงุฑุฌูุฉ ูุซู WeasyPrint.
* ูุชุทูุจ ุจูุฆุฉ ุชุดุบูู ูุงููุฉ (Python + ูุชุตูุญ + ูููุงุช ุฎุงุฏู).
* ุบูุฑ ุนููู ูููุณุชุฎุฏููู ุงูุฐูู ูุชุนุงูููู ูุน ูููุงุช Excel ุบูุฑ ููุญุฏุฉ ูู ูุตุงุฏุฑ ูุฎุชููุฉ.

ุงููุชูุฌุฉ: ุชุฌุฑุจุฉ ุงุณุชุฎุฏุงู ุซูููุฉุ ุฑุบู ุฌูุฏุฉ ุงููุฎุฑุฌุงุช.

---

## 3. ุงูุฑุคูุฉ ุงูุฌุฏูุฏุฉ โ BGLApp Lite

> **ุชุทุจูู ููุชุจู ุฐูู (Smart Excel Processor)** ูููู ุจู:
>
> * ูุฑุงุกุฉ ุฃู ููู Excel.
> * ุชุญููู ุงูุฃุนูุฏุฉ ุชููุงุฆููุง ุจุงุณุชุฎุฏุงู Fuzzy Matching.
> * ุชูุธูู ูุชุตุญูุญ ุงูููู (ูุบุฉุ ุฃุฑูุงูุ ุชูุงุฑูุฎ).
> * ุชุนุจุฆุฉ ุจูุงูุงุช ุงูุจููู ูุงูุดุฑูุงุช ุชููุงุฆููุง.
> * ุนุฑุถ ุงููุชุงุฆุฌ ูููุฑุงุฌุนุฉ.
> * ุชูููุฏ ููู PDF ุงุญุชุฑุงูู ููู ุตู.

---

## 4. ุงููุนูุงุฑูุฉ ุงูุฌุฏูุฏุฉ (System Architecture)

```
BGLApp_Lite/
โ
โโโ app/
โ   โโโ core/                  โ ูุญุฑู ุงููุนุงูุฌุฉ ุงูุฐูู (Smart Excel Processor)
โ   โ   โโโ processor.py       โ ุฎูุงุฑุฒููุฉ ุงูุชุญููู ูุงูุชุทุจูุน
โ   โ   โโโ normalizer.py      โ ุชูุธูู ูุชูุญูุฏ ุงูููู
โ   โ   โโโ pdf_generator.py   โ ุฅูุดุงุก PDF ูู ูุงูุจ HTML
โ   โ   โโโ utils.py           โ ุฏูุงู ุงููุณุงุนุฏุฉ ุงูุนุงูุฉ
โ   โ
โ   โโโ gui/                   โ ุงููุงุฌูุฉ ุงูููุชุจูุฉ (Tkinter ุฃู PyQt)
โ   โ   โโโ main_window.py     โ ูุงูุฐุฉ ุงูุจุฑูุงูุฌ ุงูุฃุณุงุณูุฉ
โ   โ   โโโ dialogs.py         โ ูุฑุจุนุงุช ุงููุฑุงุฌุนุฉ ูุงูุชูุจูู
โ   โ
โ   โโโ config/                โ ูููุงุช ุงูุชุนุฑูู ูุงูููุงููุณ
โ   โ   โโโ schema_ref.json
โ   โ   โโโ banks_dict.json
โ   โ   โโโ companies_dict.json
โ   โ   โโโ default_settings.json
โ   โ
โ   โโโ templates/             โ ุงูููุงูุจ ุงูุฑุณููุฉ ููุฎุทุงุจุงุช
โ   โ   โโโ letter_template.html
โ   โ   โโโ letterhead.svg
โ   โ
โ   โโโ main.py                โ ููุทุฉ ุงูุชุดุบูู ุงูุฑุฆูุณูุฉ
โ
โโโ launcher/
โ   โโโ run_portable.py
โ   โโโ run_portable.bat
โ   โโโ icon.ico
โ
โโโ build/
    โโโ build_portable.py
```

---

## 5. ูุฑุงุญู ุงูุชูููุฐ

### ุงููุฑุญูุฉ 1: ุงูุชุญููู ูุงูุฅุนุฏุงุฏ ุงููุนุฑูู (Cognitive Setup)

**ุงููุฏุฉ:** ููู ูุงุญุฏ
**ุงููุฏู:** ุฅูุดุงุก ูููุงุช ุงููุฑุฌุน ุงูุฐููุฉ.

* `schema_ref.json`: ุฌููุน ุงุญุชูุงูุงุช ุฃุณูุงุก ุงูุฃุนูุฏุฉ (ุนุฑุจูุฉ + ุฅูุฌููุฒูุฉ).
* `banks_dict.json`: ุฃุณูุงุก ุงูุจููู ุจุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ.
* `companies_dict.json`: ุฃุณูุงุก ุงูุดุฑูุงุช ูุงูููุฑุฏูู.
* `default_settings.json`: ุฅุนุฏุงุฏุงุช ุงูุชุดุบูู ุงูุงูุชุฑุงุถูุฉ.

๐ฏ **ุงููุชูุฌุฉ:** ูุงุนุฏุฉ ูุนุฑููุฉ ุฐููุฉ ููุชุนุงูู ูุน ูููุงุช Excel ุงููุชููุนุฉ.

---

### ุงููุฑุญูุฉ 2: ุจูุงุก Smart Excel Processor

**ุงููุฏุฉ:** 2โ3 ุฃูุงู
**ุงููุธุงุฆู:**

1. **ูุฑุงุกุฉ ุงูุฃุนูุฏุฉ ูุงูุตููู** (pandas + openpyxl)

* ุงูุชุดุงู ุงููุฑูุฉ ุงูููุงุณุจุฉ ุชููุงุฆููุง (ุฃูู ูุฑูุฉ ุฃู ุงูุชู ุชุญุชูู ุฑุคูุณูุง ูุนุฑููุฉ).
* ูุฑุงุกุฉ ุงูุตู ุงูุฃูู ูุฑุคูุณ (headers) ูุน ุญูุงูุฉ ูู ุงูุฎูุงูุง ุงููุฏูุฌุฉ.

2. **ุชุทุงุจู/ุชุนููู ุงูุฃุณูุงุก (Fuzzy Header Mapping)**

* ุงุณุชุฎุฏุงู RapidFuzz ูุงุดุชูุงู ุฃูุฑุจ ุงุณู ููุงุณู ูู `schema_ref.json` ุญุชู ูู ูุงู ุงูุงุณู ุจุงูุนุฑุจูุฉ/ุงูุฅูุฌููุฒูุฉ/ูุฎุชุตุฑูุง.
* ุชุฌุงูู ุงูุฃุนูุฏุฉ ุบูุฑ ุงููุนุฑููุฉุ ูุฅุนุงุฏุฉ ุชุณููุฉ ุงูุฃุนูุฏุฉ ุงููุนุชุฑู ุจูุง ุฅูู ุฃุณูุงุก ููุญูุฏุฉ (canonical names).

3. **ุชูุธูู ุงูููู (Normalization & Cleansing)**

* **ุชูุงุฑูุฎ:** `python-dateutil` ูุน ูุญุงููุชู dayfirst=True/Falseุ ูุชูุญูุฏ ุงููุฎุฑุฌุงุช ุจุตูุบุฉ ISO (`YYYY-MM-DD`).
* **ูุจุงูุบ:** ุฅุฒุงูุฉ ุฑููุฒ ุงูุนููุฉ ูุงูููุงุตูุ ุชุญููู ุฅูู `float` ุซู ุฅูู ุณูุณูุฉ ุจุฃุฑูุงู ุนุฑุจูุฉ ุนูุฏ ุงูุนุฑุถ/ุงูุทุจุงุนุฉ.
* **ูุตูุต ุนุฑุจูุฉ/ุฅูุฌููุฒูุฉ:** ุชูุญูุฏ ุงูููุฒุงุช/ุงููุงุกุงุช/ุงููุงุกุงุชุ ุฅุฒุงูุฉ ุงููุฑุงุบุงุช ุบูุฑ ุงููุฑุฆูุฉุ ูุชุญููู ุงูุฃุฑูุงู ุนูุฏ ุงูุญุงุฌุฉ.

4. **ุงูุฅููุงู ุงูุชููุงุฆู (Autofill / Lookup)**

* ูุทุงุจูุฉ ุงุณู ุงูุจูู/ุงูุดุฑูุฉ ุจุงุณุชุฎุฏุงู `banks_dict.json` ู`companies_dict.json` ูุน ุฏุฑุฌุฉ ุซูุฉ (confidence).
* ุนูุฏ ุงูุชุทุงุจู: ุชุนุจุฆุฉ ุงูุญููู ุงููุดุชูุฉ (ุนููุงู ุงูุจููุ ุงููุฑุนุ ุงูุงุณู ุงูุนุฑุจู/ุงูุฅูุฌููุฒู...).

5. **ุงูุชุญูู (Validation) + ูุคุดุฑุงุช ุงูุซูุฉ**

* ุงูุชุญูู ูู ุงูุญููู ุงูุฅูุฒุงููุฉ: `bank_name`, `guarantee_number`, `amount`, `expiry_date`.
* ููู ุฎููุฉ ุชุนุฏููุงู: ุญูุธ `{original, value, method, confidence}` ูุฅุธูุงุฑูุง ูู ูุงุฌูุฉ ุงููุฑุงุฌุนุฉ.

6. **ูุฎุฑุฌุงุช ูุณูุทุฉ (Preview Model)**

* ุฅูุชุงุฌ DataFrame/JSON ูุณูุท ุฌุงูุฒ ููุนุฑุถ ูู ูุงุฌูุฉ ุงููุฑุงุฌุนุฉุ ูุน ุชูููุฒ ูููู: ุฃุฎุถุฑ (>0.9)ุ ุฃุตูุฑ (0.6โ0.9)ุ ุฃุญูุฑ (<0.6).

7. **ุงูุชุตุฏูุฑ ุงููุฑุญูู**

* ุนูุฏ ุงุนุชูุงุฏ ุงููุณุชุฎุฏู: ุญูุธ JSON ุงูููุงุฆู ููู ุตู (ุชููุฆุฉ ุงุณู ููู ุชููุงุฆู)ุ ุซู ุชูุฑูุฑู ุฅูู ููููุฏ PDF.

> **ููุงุญุธุงุช ุชูููุฐูุฉ:**
>
> * ุฌููุน ุงูููุงููุณ ูู `app/config/` ูุน ุฅุตุฏุงุฑ (version) ูุชุณููู ุงูุชุญุฏูุซ ุงููุณุชูุจูู.
> * ุชุณุฌูู ุฃุญุฏุงุซ ูุธููุฉ ุฅูู `app/data/logs/processor.log` (ูุฌุงุญุงุช/ุชุญุฐูุฑุงุช/ุฃุฎุทุงุก).
